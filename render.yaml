services:
  - type: web
    name: fullstack-academy-backend
    runtime: docker
    plan: free
    rootDir: dot-net-quiz/backend
    dockerfilePath: Dockerfile
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: PORT
        value: 8080
    healthCheckPath: /api/health
    autoDeploy: true
    # Add build command to avoid BuildKit issues
    buildCommand: "docker build -t backend ."

  - type: web
    name: fullstack-academy-frontend
    runtime: docker
    plan: free
    rootDir: dot-net-quiz/frontend
    dockerfilePath: Dockerfile
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_API_BASE
        value: https://fullstack-academy-backend.onrender.com
    healthCheckPath: /
    autoDeploy: true
    # Add build command to avoid BuildKit issues
    buildCommand: "docker build -t frontend ."